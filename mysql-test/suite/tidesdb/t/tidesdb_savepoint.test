--source include/not_embedded.inc

--echo #
--echo # ============================================
--echo # TEST: SQL SAVEPOINT support
--echo # ============================================
--echo #

CREATE TABLE t_sp (
  id INT PRIMARY KEY,
  v  INT
) ENGINE=TIDESDB;

--echo # SAVEPOINT should work inside an explicit transaction
START TRANSACTION;
INSERT INTO t_sp VALUES (1, 10);
SAVEPOINT a;
INSERT INTO t_sp VALUES (2, 20);
ROLLBACK TO SAVEPOINT a;
INSERT INTO t_sp VALUES (3, 30);
RELEASE SAVEPOINT a;
COMMIT;

SELECT * FROM t_sp ORDER BY id;

DROP TABLE t_sp;

--echo #
--echo # Done.
