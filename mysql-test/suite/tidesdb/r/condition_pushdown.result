#
# Test Table Condition Pushdown (HA_CAN_TABLE_CONDITION_PUSHDOWN)
#
DROP TABLE tidesdb_check;
CREATE TABLE t1 (
id INT PRIMARY KEY,
a INT,
b INT,
c VARCHAR(100)
) ENGINE=TidesDB;
INSERT INTO t1 VALUES (1, 10, 100, 'row1');
INSERT INTO t1 VALUES (2, 20, 200, 'row2');
INSERT INTO t1 VALUES (3, 30, 300, 'row3');
INSERT INTO t1 VALUES (4, 40, 400, 'row4');
INSERT INTO t1 VALUES (5, 50, 500, 'row5');
INSERT INTO t1 VALUES (6, 60, 600, 'row6');
INSERT INTO t1 VALUES (7, 70, 700, 'row7');
INSERT INTO t1 VALUES (8, 80, 800, 'row8');
INSERT INTO t1 VALUES (9, 90, 900, 'row9');
INSERT INTO t1 VALUES (10, 100, 1000, 'row10');
# Test 1: Simple condition pushdown on table scan
EXPLAIN SELECT * FROM t1 WHERE a > 50;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	10	Using where
SELECT * FROM t1 WHERE a > 50 ORDER BY id;
id	a	b	c
6	60	600	row6
7	70	700	row7
8	80	800	row8
9	90	900	row9
10	100	1000	row10
# Test 2: Multiple conditions
EXPLAIN SELECT * FROM t1 WHERE a > 30 AND b < 700;
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	10	Using where
SELECT * FROM t1 WHERE a > 30 AND b < 700 ORDER BY id;
id	a	b	c
4	40	400	row4
5	50	500	row5
6	60	600	row6
# Test 3: String condition
EXPLAIN SELECT * FROM t1 WHERE c LIKE 'row%';
id	select_type	table	type	possible_keys	key	key_len	ref	rows	Extra
1	SIMPLE	t1	ALL	NULL	NULL	NULL	NULL	10	Using where
SELECT * FROM t1 WHERE c LIKE 'row1%' ORDER BY id;
id	a	b	c
1	10	100	row1
10	100	1000	row10
# Test 4: OR condition
SELECT * FROM t1 WHERE a = 20 OR a = 80 ORDER BY id;
id	a	b	c
2	20	200	row2
8	80	800	row8
# Test 5: IN condition
SELECT * FROM t1 WHERE a IN (10, 30, 50, 70, 90) ORDER BY id;
id	a	b	c
1	10	100	row1
3	30	300	row3
5	50	500	row5
7	70	700	row7
9	90	900	row9
# Test 6: BETWEEN condition
SELECT * FROM t1 WHERE b BETWEEN 300 AND 700 ORDER BY id;
id	a	b	c
3	30	300	row3
4	40	400	row4
5	50	500	row5
6	60	600	row6
7	70	700	row7
# Test 7: Complex condition
SELECT * FROM t1 WHERE (a > 30 AND b < 600) OR c = 'row9' ORDER BY id;
id	a	b	c
4	40	400	row4
5	50	500	row5
9	90	900	row9
# Cleanup
DROP TABLE t1;
#
# Condition pushdown tests completed!
#
