#
# TidesDB Edge Cases and Error Handling Tests
#
DROP TABLE IF EXISTS tidesdb_check;
# Test 1: Empty table operations
CREATE TABLE t1 (
id INT PRIMARY KEY,
name VARCHAR(100)
) ENGINE=TidesDB;
SELECT COUNT(*) FROM t1;
COUNT(*)
0
SELECT * FROM t1;
id	name
DELETE FROM t1;
TRUNCATE TABLE t1;
# Test 2: Large VARCHAR values
INSERT INTO t1 VALUES (1, REPEAT('A', 100));
SELECT id, LENGTH(name) FROM t1;
id	LENGTH(name)
1	100
# Test 3: NULL handling
DROP TABLE t1;
CREATE TABLE t1 (
id INT PRIMARY KEY,
name VARCHAR(100),
value INT
) ENGINE=TidesDB;
INSERT INTO t1 VALUES (1, NULL, NULL);
INSERT INTO t1 VALUES (2, 'Bob', NULL);
INSERT INTO t1 VALUES (3, NULL, 300);
INSERT INTO t1 VALUES (4, 'Dave', 400);
SELECT * FROM t1 ORDER BY id;
id	name	value
1	NULL	NULL
2	Bob	NULL
3	NULL	300
4	Dave	400
SELECT * FROM t1 WHERE name IS NULL ORDER BY id;
id	name	value
1	NULL	NULL
3	NULL	300
SELECT * FROM t1 WHERE value IS NULL ORDER BY id;
id	name	value
1	NULL	NULL
2	Bob	NULL
SELECT * FROM t1 WHERE name IS NOT NULL ORDER BY id;
id	name	value
2	Bob	NULL
4	Dave	400
# Test 4: UPDATE to NULL
UPDATE t1 SET name = NULL WHERE id = 4;
SELECT * FROM t1 ORDER BY id;
id	name	value
1	NULL	NULL
2	Bob	NULL
3	NULL	300
4	NULL	400
# Test 5: Duplicate key error
INSERT INTO t1 VALUES (1, 'Duplicate', 999);
ERROR 23000: Can't write; duplicate key in table 't1'
# Test 6: Very long table name (skipped - identifier length varies by platform)
# Test 7: Boundary values for INT
DROP TABLE t1;
CREATE TABLE t1 (
id INT PRIMARY KEY,
val_int INT,
val_bigint BIGINT
) ENGINE=TidesDB;
INSERT INTO t1 VALUES (1, 2147483647, 9223372036854775807);
INSERT INTO t1 VALUES (2, -2147483648, -9223372036854775808);
INSERT INTO t1 VALUES (3, 0, 0);
SELECT * FROM t1 ORDER BY id;
id	val_int	val_bigint
1	2147483647	9223372036854775807
2	-2147483648	-9223372036854775808
3	0	0
# Test 8: Empty string vs NULL
DROP TABLE t1;
CREATE TABLE t1 (
id INT PRIMARY KEY,
name VARCHAR(100)
) ENGINE=TidesDB;
INSERT INTO t1 VALUES (1, '');
INSERT INTO t1 VALUES (2, NULL);
INSERT INTO t1 VALUES (3, ' ');
SELECT id, name, LENGTH(name), name IS NULL FROM t1 ORDER BY id;
id	name	LENGTH(name)	name IS NULL
1		0	0
2	NULL	NULL	1
3	 	1	0
# Test 9: Case sensitivity in LIKE
INSERT INTO t1 VALUES (4, 'Alice');
INSERT INTO t1 VALUES (5, 'ALICE');
INSERT INTO t1 VALUES (6, 'alice');
SELECT * FROM t1 WHERE name LIKE 'Alice' ORDER BY id;
id	name
4	Alice
5	ALICE
6	alice
SELECT * FROM t1 WHERE name LIKE 'alice' ORDER BY id;
id	name
4	Alice
5	ALICE
6	alice
SELECT * FROM t1 WHERE name LIKE '%lice%' ORDER BY id;
id	name
4	Alice
5	ALICE
6	alice
# Test 10: ORDER BY with NULL values
SELECT * FROM t1 ORDER BY name ASC;
id	name
2	NULL
1	
3	 
4	Alice
5	ALICE
6	alice
SELECT * FROM t1 ORDER BY name DESC;
id	name
4	Alice
5	ALICE
6	alice
1	
3	 
2	NULL
# Cleanup
DROP TABLE t1;
#
# Edge cases tests completed!
#
