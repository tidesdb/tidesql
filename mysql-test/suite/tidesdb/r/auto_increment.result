#
# TidesDB Auto-Increment Tests
#
DROP TABLE IF EXISTS tidesdb_check;
# Test 1: Basic auto-increment
CREATE TABLE t1 (
id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(100)
) ENGINE=TidesDB;
INSERT INTO t1 (name) VALUES ('row1');
INSERT INTO t1 (name) VALUES ('row2');
INSERT INTO t1 (name) VALUES ('row3');
SELECT * FROM t1 ORDER BY id;
id	name
1	row1
2	row2
3	row3
# Test 2: LAST_INSERT_ID()
INSERT INTO t1 (name) VALUES ('row4');
SELECT LAST_INSERT_ID();
LAST_INSERT_ID()
4
# Test 3: Explicit ID with auto-increment
INSERT INTO t1 (id, name) VALUES (100, 'explicit100');
INSERT INTO t1 (name) VALUES ('after100');
SELECT * FROM t1 ORDER BY id;
id	name
1	row1
2	row2
3	row3
4	row4
5	after100
100	explicit100
# Test 4: Auto-increment after DELETE
DELETE FROM t1 WHERE id = 100;
INSERT INTO t1 (name) VALUES ('afterDelete');
SELECT * FROM t1 ORDER BY id;
id	name
1	row1
2	row2
3	row3
4	row4
5	after100
6	afterDelete
# Test 5: Auto-increment with TRUNCATE (bug fix test)
TRUNCATE TABLE t1;
INSERT INTO t1 (name) VALUES ('afterTruncate1');
INSERT INTO t1 (name) VALUES ('afterTruncate2');
SELECT * FROM t1 ORDER BY id;
id	name
1	afterTruncate1
2	afterTruncate2
# Test 6: BIGINT auto-increment
CREATE TABLE t2 (
id BIGINT AUTO_INCREMENT PRIMARY KEY,
data VARCHAR(100)
) ENGINE=TidesDB;
INSERT INTO t2 (data) VALUES ('big1'), ('big2'), ('big3');
SELECT * FROM t2 ORDER BY id;
id	data
1	big1
2	big2
3	big3
# Test 7: Multi-row INSERT with auto-increment
DROP TABLE t1;
CREATE TABLE t1 (
id INT AUTO_INCREMENT PRIMARY KEY,
name VARCHAR(100)
) ENGINE=TidesDB;
INSERT INTO t1 (name) VALUES ('multi1'), ('multi2'), ('multi3');
SELECT * FROM t1 ORDER BY id;
id	name
1	multi1
2	multi2
3	multi3
# Cleanup
DROP TABLE t1, t2;
#
# Auto-increment tests completed!
#
